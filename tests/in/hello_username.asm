PROMPT: VAR 'What is your name?'
GREETING: VAR 'Hello, '
SUFFIX: VAR '!'
VAR 0
BUFFER_START: VAR 500
I: VAR 0
START: LD PROMPT
ST I
PRINT_PROMPT: LD [I]
CMP 0
JZ PREPARE_INPUT
ST 2047
LD (I)
ADD 1
ST I
JMP PRINT_PROMPT
PREPARE_INPUT: LD (BUFFER_START)
ST I
LD 10
ST 2047
CYCLE: LD (2046)
ST (I)
CMP 0
JZ PRINT_GREETING
LD (I)
ADD 1
ST I
JMP CYCLE
PRINT_GREETING: LD GREETING
ST I
GREETING_CYCLE: LD [I]
CMP 0
JZ PRINT_USERNAME
ST 2047
LD (I)
ADD 1
ST I
JMP GREETING_CYCLE
PRINT_USERNAME: LD (BUFFER_START)
ST I
USERNAME_CYCLE: LD [I]
CMP 10
JZ SKIP_NEWLINE
LD [I]
CMP 0
JZ PRINT_SUFFIX
ST 2047
SKIP_NEWLINE: LD (I)
ADD 1
ST I
JMP USERNAME_CYCLE
PRINT_SUFFIX: LD SUFFIX
ST I
SUFFIX_CYCLE: LD [I]
CMP 0
JZ STOP
ST 2047
LD (I)
ADD 1
ST I
JMP SUFFIX_CYCLE
STOP: HLT
